System.register(["react","mobx","jb-modules/DateTimeModule/dist/DateTimeConverter.min","mobx-react","./JBDateInput.css!"],function(a){'use strict';var b,c,d,e,f,g;return{setters:[function(a){b=a.default},function(a){c=a.extendObservable,d=a.observable,e=a.observe},function(a){f=a.default},function(a){g=a.observer},function(){}],execute:function(){function h(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function i(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function j(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function k(a,b,c){return b&&j(a.prototype,b),c&&j(a,c),a}function l(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}function m(a){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m(a)}function n(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function o(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function p(a,b,c){return b&&o(a.prototype,b),c&&o(a,c),a}function q(a,b){return b&&("object"===m(b)||"function"==typeof b)?b:r(a)}function r(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function s(a){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},s(a)}function t(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&u(a,b)}function u(a,b){return u=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},u(a,b)}var v,w,x,y,z,A,B=(v=(z=function(){function a(b){var c=this;i(this,a),h(this,"componentStatus",w,this),h(this,"elements",x,this),h(this,"defaultConfig",y,this),this.config=null,this.valueString="",this.isValid=!1,this.errorMessage="",this.onKeyPressEvent=void 0,this.onSubmitEvent=void 0,this.gregorianDateObj=null;e(this.componentStatus,function(a){return c.onComponentStatusFocusChange(a)});this.config=this.mergeObject(b.config,this.defaultConfig),this.onChangeEvent=b.onChange,this.onKeyPressEvent=b.onKeyPress||function(){},this.onSubmitEvent=b.onSubmit||function(){},this.valueString=b.value,!0==b.autoFocus&&(this.config.autoFocus=!0),this.inputMaskToRegex()}return k(a,[{key:"mergeObject",value:function(a,b){var d={};for(var e in b)(null==a[e]||null==a[e])&&(d[e]=b[e]);return c(a,d),a}},{key:"inputMaskToRegex",value:function(){var a=this.config.inputMask.replace("yyyy","(?<year>\\d{4})").replace("MM","(?<month>\\d{2})").replace("dd","(?<day>\\d{2})").replace("HH","(?<hour>\\d{2})").replace("mm","(?<minute>\\d{2})").replace("ss","(?<second>\\d{2})").replace(".SSS","(?:.(?<milliSecond>\\d{1,3})){0,1}").replace("SSS","(?<milliSecond>\\d{1,3})").replace("ZZ","(?<timeZone>([+-](?<timeZoneHour>2[0-3]|[01][0-9]):(?<timeZoneMinute>[0-5][0-9])){0,1})");this.config.inputMaskRegex=new RegExp(a,"g")}},{key:"updateCalendarValue",value:function(a){if(""!=this.valueString&&this.valueString){var b=this.decodeValueString(a),c=f.convertGregorianToJalali(b.year,b.month,b.day);this.config.jalaliDateObj=c,this.valueString=a,this.updateUiValueByConfigData()}}},{key:"updateUiValueByConfigData",value:function(){if(this.elements.yearInput.current&&this.elements.monthInput.current&&this.elements.dayInput.current){this.elements.yearInput.current.value=this.config.jalaliDateObj.year;var a=this.config.jalaliDateObj.month;10>this.config.jalaliDateObj.month&&(a="0"+a),this.elements.monthInput.current.value=a;var b=this.config.jalaliDateObj.day;10>this.config.jalaliDateObj.day&&(b="0"+b),this.elements.dayInput.current.value=b}}},{key:"decodeValueString",value:function(a){this.config.inputMaskRegex.lastIndex=0;var b=this.config.inputMaskRegex.exec(a);return b.groups}},{key:"onYearInputFocus",value:function(){return this.componentStatus.focus="year",!0}},{key:"onMonthInputFocus",value:function(){return this.componentStatus.focus="month",!0}},{key:"onDayInputFocus",value:function(){return this.componentStatus.focus="day",!0}},{key:"onYearInputBlur",value:function(){return this.componentStatus.focus="",!0}},{key:"onMonthInputBlur",value:function(){return this.componentStatus.focus="",!0}},{key:"onDayInputBlur",value:function(){return this.componentStatus.focus="",!0}},{key:"onContainerClick",value:function(a){a.target==this.elements.inputBox.current&&(this.componentStatus.focus="year",this.elements.yearInput.current.setSelectionRange(0,0))}},{key:"onComponentStatusFocusChange",value:function(a){switch(a.object.focus){case"year":this.elements.yearInput.current.focus();break;case"month":this.elements.monthInput.current.focus();break;case"day":this.elements.dayInput.current.focus();break;case"":this.updateCalenderData();}}},{key:"onYearInputKeyPress",value:function(a){var b=this.elements.yearInput.current.selectionStart,c=a.key;return 4==b?(this.componentStatus.focus="month","/"==c?this.elements.monthInput.current.setSelectionRange(0,0):this.InputChartoBox(c,this.elements.monthInput.current,0)):this.InputChartoBox(c,this.elements.yearInput.current,b),this.onKeyPressEvent(a),a.preventDefault(),!1}},{key:"onMonthInputKeyPress",value:function(a){var b=this.elements.monthInput.current.selectionStart,c=a.key;return 2==b?(this.componentStatus.focus="day","/"==c?this.elements.dayInput.current.setSelectionRange(0,0):this.InputChartoBox(c,this.elements.dayInput.current,0)):this.InputChartoBox(c,this.elements.monthInput.current,b),this.onKeyPressEvent(a),a.preventDefault(),!1}},{key:"onDayInputKeyPress",value:function(a){var b=this.elements.dayInput.current.selectionStart,c=a.key;1<b&&(b=1),this.InputChartoBox(c,this.elements.dayInput.current,b),this.onKeyPressEvent(a),a.preventDefault()}},{key:"InputChartoBox",value:function(a,b,c){if(!isNaN(a)){if(b===this.elements.monthInput.current){if(1<parseInt(a)&&0==c&&(this.InputChartoBox("0",this.elements.monthInput.current,0),a=a,c++),1==c&&"1"==this.elements.monthInput.current.value[0]&&2<a)return;0==c&&"2"<this.elements.monthInput.current.value[1]&&"1"==a&&this.InputChartoBox("0",this.elements.monthInput.current,1)}if(b===this.elements.dayInput.current){if(3<parseInt(a)&&0==c&&(this.InputChartoBox("0",this.elements.dayInput.current,0),c++),1==c&&"3"==this.elements.dayInput.current.value[0]&&1<a)return;0==c&&"1"<this.elements.dayInput.current.value[1]&&"3"==a&&this.InputChartoBox("0",this.dayInput.current,1)}var d,e=b.value,f=b==this.elements.yearInput.current?4:2;d=e.length==f?1:0;var g=e.substr(0,c)+a+e.substr(c+d);b===this.elements.dayInput.current&&(this.config.jalaliDateObj.day=parseInt(g)),b===this.elements.monthInput.current&&(this.config.jalaliDateObj.month=parseInt(g)),b===this.elements.yearInput.current&&(this.config.jalaliDateObj.year=parseInt(g)),b.value=g,b.setSelectionRange(c+1,c+1)}}},{key:"onYearInputKeyDown",value:function(a){if(39==a.keyCode){var b=this.elements.yearInput.current.selectionStart;if(4==b)return this.componentStatus.focus="month",this.elements.monthInput.current.setSelectionRange(0,0),a.stopPropagation(),!1}return 38==a.keyCode&&this.addToDate(1,"year"),40==a.keyCode&&this.addToDate(-1,"year"),!0}},{key:"onMonthInputKeyDown",value:function(a){if(39==a.keyCode){var b=this.elements.monthInput.current.selectionStart;if(2==b)return this.componentStatus.focus="day",this.elements.dayInput.current.setSelectionRange(0,0),a.stopPropagation(),!1}if(37==a.keyCode){var b=this.elements.monthInput.current.selectionStart;if(0==b)return this.componentStatus.focus="year",this.elements.yearInput.current.setSelectionRange(4,4),a.stopPropagation(),!1}if(38==a.keyCode&&this.addToDate(1,"month"),40==a.keyCode&&this.addToDate(-1,"month"),8==a.keyCode){var b=this.elements.monthInput.current.selectionStart;0==b&&(this.componentStatus.focus="year",this.elements.yearInput.current.setSelectionRange(4,4))}return!0}},{key:"onDayInputKeyDown",value:function(a){if(37==a.keyCode){var b=this.elements.dayInput.current.selectionStart;if(0==b)return this.componentStatus.focus="month",this.elements.monthInput.current.setSelectionRange(2,2),a.stopPropagation(),!1}if(38==a.keyCode&&this.addToDate(1,"day"),40==a.keyCode&&this.addToDate(-1,"day"),8==a.keyCode){var b=this.elements.dayInput.current.selectionStart;0==b&&(this.componentStatus.focus="month",this.elements.monthInput.current.setSelectionRange(2,2))}return!0}},{key:"onYearInputKeyUp",value:function(a){13==a.keyCode&&this.validateDate()&&(this.updateCalenderData(),this.onSubmitEvent(a))}},{key:"onMonthInputKeyUp",value:function(a){13==a.keyCode&&this.validateDate()&&(this.updateCalenderData(),this.onSubmitEvent(a))}},{key:"onDayInputKeyUp",value:function(a){13==a.keyCode&&this.validateDate()&&(this.updateCalenderData(),this.onSubmitEvent(a))}},{key:"addToDate",value:function(a,b){switch(b){case"day":var c=parseInt(this.elements.dayInput.current.value);if(31>=c+a&&0<a){var d=c+a;10>d&&(d="0"+d),this.elements.dayInput.current.value=d,this.config.jalaliDateObj.day=d}if(0<c+a&&0>a){var e=c+a;10>e&&(e="0"+e),this.elements.dayInput.current.value=e,this.config.jalaliDateObj.day=e}break;case"month":var c=parseInt(this.elements.monthInput.current.value);if(12>=c+a&&0<a){var f=c+a;10>f&&(f="0"+f),this.elements.monthInput.current.value=f,this.config.jalaliDateObj.month=f}if(0<c+a&&0>a){var g=c+a;10>g&&(g="0"+g),this.elements.monthInput.current.value=g,this.config.jalaliDateObj.month=g}break;case"year":var c=parseInt(this.elements.yearInput.current.value);if(9999>c+a&&0<a){var h=c+a;this.elements.yearInput.current.value=h,this.config.jalaliDateObj.year=h}if(1e3<c+a&&0>a){var i=c+a;this.elements.yearInput.current.value=i}}this.updateCalenderData()}},{key:"updateCalenderData",value:function(){var a=this.config.jalaliDateObj.year,b=this.config.jalaliDateObj.month,c=this.config.jalaliDateObj.day;this.gregorianDateObj=f.convertJalaliToGregorian(a,b,c);var d,e,g,h=this.gregorianDateObj.year,i=this.gregorianDateObj.month,j=this.gregorianDateObj.day;"gregorian"==this.config.InputDateType?(d=h,e=i,g=j):(d=a,e=b,g=c);var k=this.config.inputMask;k=k.replace("yyyy",d);var l=10>g?"0"+g:g;k=k.replace("dd",l);var m=10>e?"0"+e:e;k=k.replace("MM",m),k=k.replace("HH","12"),k=k.replace("mm","00"),k=k.replace("ss","00"),k=k.replace("SSS","000"),k=k.replace("ZZ","+00:00"),k=k.replace("aaa","AM"),this.config.value=k;var n=this.createEventDetailObject(k);"function"==typeof this.onChangeEvent&&this.callOnChangeEvent(k,n)}},{key:"createEventDetailObject",value:function(a){var b={jalaliDateObj:this.config.jalaliDateObj,gregorianDateObj:this.gregorianDateObj,value:a,isValid:this.validateDate(),errorMessage:this.errorMessage};return b}},{key:"callOnChangeEvent",value:function(a,b){var c=this,d=new CustomEvent("change",{detail:b,bubbles:!0,cancelable:!0});d.simulated=!0;var e=this.elements.componentDom.current._valueTracker;return e&&e.setValue(a),this.elements.componentDom.current.value=a,this.elements.componentDom.current.onchange=function(a){return c.onChangeEvent(a)},this.elements.componentDom.current.dispatchEvent(d),d}},{key:"validateDate",value:function(){this.isValid=!0,this.errorMessage="";var a=this.elements.yearInput.current.value,b=this.elements.monthInput.current.value,c=this.elements.dayInput.current.value;if((isNaN(a)&&(this.errorMessage="\u0645\u0642\u062F\u0627\u0631 \u0633\u0627\u0644 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u0639\u062F\u062F\u06CC \u0646\u06CC\u0633\u062A",this.isValid=!1),isNaN(b)&&(this.errorMessage="\u0645\u0642\u062F\u0627\u0631 \u0645\u0627\u0647 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u0639\u062F\u062F\u06CC \u0646\u06CC\u0633\u062A",this.isValid=!1),isNaN(c)&&(this.errorMessage="\u0645\u0642\u062F\u0627\u0631 \u0631\u0648\u0632 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u0639\u062F\u062F\u06CC \u0646\u06CC\u0633\u062A",this.isValid=!1),!1!=this.isValid)&&(""==a&&(this.errorMessage="\u0633\u0627\u0644 \u062D\u062A\u0645\u0627 \u0645\u06CC\u0628\u0627\u06CC\u0633\u062A \u0648\u0627\u0631\u062F \u0634\u0648\u062F",this.isValid=!1),""==b&&(this.errorMessage="\u0645\u0627\u0647 \u062D\u062A\u0645\u0627 \u0645\u06CC\u0628\u0627\u06CC\u0633\u062A \u0648\u0627\u0631\u062F \u0634\u0648\u062F",this.isValid=!1),""==c&&(this.errorMessage="\u0631\u0648\u0632 \u062D\u062A\u0645\u0627 \u0645\u06CC\u0628\u0627\u06CC\u0633\u062A \u0648\u0627\u0631\u062F \u0634\u0648\u062F",this.isValid=!1),!1!=this.isValid)){var d=parseInt(b),e=parseInt(c);if(1>d||12<d)return this.errorMessage="\u0645\u0627\u0647 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u062F\u0631 \u0628\u0627\u0632\u0647 \u0635\u062D\u06CC\u062D \u0646\u0645\u06CC \u0628\u0627\u0634\u062F",void(this.isValid=!1);if(1>e||31<e)return this.errorMessage="\u0631\u0648\u0632 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u062F\u0631 \u0628\u0627\u0632\u0647 \u0635\u062D\u06CC\u062D \u0646\u0645\u06CC \u0628\u0627\u0634\u062F",void(this.isValid=!1);return[7,8,9,10,11,12].includes(d)&&31==e?(this.errorMessage="\u0645\u0627\u0647 \u0648\u0627\u0631\u062F \u0634\u062F\u0647 \u0633\u06CC \u0648 \u06CC\u06A9 \u0631\u0648\u0632\u0647 \u0646\u06CC\u0633\u062A ",void(this.isValid=!1)):this.isValid}}}]),a}(),z),w=l(v.prototype,"componentStatus",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{focus:""}}}),x=l(v.prototype,"elements",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{componentDom:b.createRef(),yearInput:b.createRef(),monthInput:b.createRef(),dayInput:b.createRef(),inputBox:b.createRef()}}}),y=l(v.prototype,"defaultConfig",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{value:null,jalaliDateObj:{year:"null",month:null,day:null},InputDateType:"gregorian",inputMask:"yyyy-MM-ddTHH:mm:ss.SSSZZ",inputMaskRegex:null}}}),v),C=g(A=function(a){function c(a){var b;return n(this,c),b=q(this,s(c).call(this,a)),b.service=new B(a),b}return t(c,a),p(c,[{key:"componentDidMount",value:function(){this.props.value&&""!=this.props.value&&this.service.updateCalendarValue(this.props.value),this.service.config.autoFocus&&this.service.elements.yearInput.current.focus()}},{key:"componentWillReceiveProps",value:function(a){this.service.valueString!=a.value&&this.service.updateCalendarValue(a.value)}},{key:"render",value:function(){var a=this;return b.createElement("div",{className:"jb-date-input-component "+this.props.className,ref:this.service.elements.componentDom,style:this.props.style},b.createElement("div",{className:"jb-date-input-box",ref:this.service.elements.inputBox,onClick:function(b){return a.service.onContainerClick(b)}},b.createElement("input",{onKeyDown:function(b){return a.service.onDayInputKeyDown(b)},onKeyPress:function(b){return a.service.onDayInputKeyPress(b)},ref:this.service.elements.dayInput,onKeyUp:function(b){return a.service.onDayInputKeyUp(b)},onFocus:function(b){return a.service.onDayInputFocus(b)},onBlur:function(b){return a.service.onDayInputBlur(b)},className:"day-input"}),b.createElement("span",{className:"slash-seperator"},"/"),b.createElement("input",{onKeyDown:function(b){return a.service.onMonthInputKeyDown(b)},onKeyPress:function(b){return a.service.onMonthInputKeyPress(b)},ref:this.service.elements.monthInput,onFocus:function(b){return a.service.onMonthInputFocus(b)},onBlur:function(b){return a.service.onMonthInputBlur(b)},className:"month-input"}),b.createElement("span",{className:"slash-seperator"},"/"),b.createElement("input",{onKeyDown:function(b){return a.service.onYearInputKeyDown(b)},onKeyPress:function(b){return a.service.onYearInputKeyPress(b)},ref:this.service.elements.yearInput,onFocus:function(b){return a.service.onYearInputFocus(b)},onBlur:function(b){return a.service.onYearInputBlur(b)},className:"year-input"})))}}]),c}(b.Component))||A;a("default",C)}}});
